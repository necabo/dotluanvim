local execute = vim.api.nvim_command
local fn = vim.fn

local install_path = fn.stdpath("data").."/site/pack/packer/start/packer.nvim"

if fn.empty(fn.glob(install_path)) > 0 then
    fn.system({"git", "clone", "https://github.com/wbthomason/packer.nvim", install_path})
    execute "packadd packer.nvim"
end

function create_augroup(autocmds, name)
  vim.cmd("augroup " .. name)
  vim.cmd("autocmd!")
  for _, autocmd in ipairs(autocmds) do
    vim.cmd("autocmd " .. table.concat(autocmd, " "))
  end
  vim.cmd("augroup END")
end

create_augroup({{[[BufWritePost plugins.lua source <afile> | PackerCompile]]}}, "necabo_auto_packer_compile")

local packer = require("packer")

packer.init()

packer.startup {
    function()
        local use = use
        use "hrsh7th/nvim-compe"
        use {
            "npxbr/gruvbox.nvim",
            requires = {"rktjmp/lush.nvim"},
            config = [[require("necabo.colors")]]
--             config = function()
--                 vim.opt.termguicolors = true
--                 vim.opt.background = "dark"
--                 vim.cmd([[colorscheme gruvbox]])
--                 vim.cmd([[highlight link sensibleWhitespaceError Error]])
--                 create_augroup(
--                     {{[[Syntax * syntax match sensibleWhitespaceError excludenl /\v\s+%#@<!$| +\ze\t/ display containedin=ALL]]}},
--                     "necabo_highlight_whitespace_error"
--                 )
--             end
        }
        use {
            "nvim-treesitter/nvim-treesitter",
            run = ":TSUpdate"
        }
        use "neovim/nvim-lspconfig"
        use {
            "nvim-telescope/telescope.nvim",
            requires = {{"nvim-lua/popup.nvim"}, {"nvim-lua/plenary.nvim"}}
        }
    end
}
